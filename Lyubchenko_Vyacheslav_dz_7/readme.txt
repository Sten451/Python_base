Задача 2.
Топорное решение. Наверняка есть более как обычно простое, но не для меня...

Задача 3.
Просто ад. Два дня полных. До последнего пытался решить с помощью сopytree, либо это невозможно, либо ...

Задача 5. 
Интересная.

