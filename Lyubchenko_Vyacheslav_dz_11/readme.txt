Спасибо что проверяете. Представляю какой это кошмар.
Все мысли в коде.